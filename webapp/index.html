<!-- –û–±–Ω–æ–≤–ª—è–π—Ç–µ –Ω–æ–º–µ—Ä –≤–µ—Ä—Å–∏–∏ (?v=20241205) –≤ —Å—Å—ã–ª–∫–∞—Ö –Ω–∞ js/css –ø–æ—Å–ª–µ –ª—é–±—ã—Ö –ø—Ä–∞–≤–æ–∫ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞, —á—Ç–æ–±—ã —Å–±—Ä–∞—Å—ã–≤–∞—Ç—å –∫—ç—à –≤ –±—Ä–∞—É–∑–µ—Ä–∞—Ö. -->
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MiniDeN ‚Äî —É—é—Ç–Ω—ã–µ –∫–æ—Ä–∑–∏–Ω–∫–∏ –∏ –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å—ã</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="css/theme.css?v=20250412" />
</head>
<body data-theme="purple" class="page-index">
  <header class="top-nav">
    <div class="brand">MiniDeN<span>—É—é—Ç–Ω—ã–µ –∫–æ—Ä–∑–∏–Ω–∫–∏ –∏ –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å—ã</span></div>
    <div class="header-actions">
      <div class="theme-switcher">
        <label for="theme-select">–¢–µ–º–∞</label>
        <select id="theme-select">
          <option value="purple">–§–∏–æ–ª–µ—Ç–æ–≤–∞—è</option>
          <option value="dark">–¢—ë–º–Ω–∞—è</option>
          <option value="light">–°–≤–µ—Ç–ª–∞—è</option>
          <option value="cream">–°–ª–∏–≤–æ—á–Ω–∞—è</option>
        </select>
      </div>
      <button class="menu-toggle" aria-label="–û—Ç–∫—Ä—ã—Ç—å –º–µ–Ω—é">‚ò∞</button>
    </div>
    <nav class="nav-links app-sidebar">
      <a href="index.html" class="active">–ì–ª–∞–≤–Ω–∞—è</a>
      <a href="products.html">–¢–æ–≤–∞—Ä—ã</a>
      <a href="masterclasses.html">–ú–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å—ã</a>
      <a href="cart.html">–ö–æ—Ä–∑–∏–Ω–∞</a>
      <a href="profile.html">–ü—Ä–æ—Ñ–∏–ª—å</a>
      <a href="admin.html" id="admin-link" style="display:none;">–ê–¥–º–∏–Ω–∫–∞</a>
    </nav>
  </header>

  <div class="app-sidebar-overlay"></div>
  <div id="toast-container"></div>

  <main>
    <section class="hero">
      <div>
        <h1>MiniDeN ‚Äî —É—é—Ç–Ω—ã–µ –∫–æ—Ä–∑–∏–Ω–∫–∏ –∏ –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å—ã –ø–æ –≤—è–∑–∞–Ω–∏—é</h1>
        <p>–ê–≤—Ç–æ—Ä—Å–∫–∏–µ –Ω–∞–±–æ—Ä—ã –¥–ª—è –¥–æ–º–∞ –∏ –ø–æ–¥–∞—Ä–∫–æ–≤, –∞ —Ç–∞–∫–∂–µ –æ–Ω–ª–∞–π–Ω-—É—Ä–æ–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥—É—Ç —Å–≤—è–∑–∞—Ç—å —Å–≤–æ–∏ –ø–µ—Ä–≤—ã–µ –∫–æ—Ä–∑–∏–Ω–∫–∏ –∏ —Å—É–º–∫–∏. –í—Å—ë –≤ –æ–¥–Ω–æ–º —Ç—ë–ø–ª–æ–º –∫–∞—Ç–∞–ª–æ–≥–µ MiniDeN.</p>
        <div class="hero-cta">
          <a class="btn" href="products.html">–ü–µ—Ä–µ–π—Ç–∏ –∫ —Ç–æ–≤–∞—Ä–∞–º</a>
          <a class="btn secondary" href="masterclasses.html">–ú–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å—ã</a>
        </div>
        <div class="pill-row">
          <span class="pill">Handmade</span>
          <span class="pill">–¢—ë–º–Ω–∞—è —Ç–µ–º–∞</span>
          <span class="pill">–î–æ—Å—Ç–∞–≤–∫–∞ –∏ –∑–∞–±–æ—Ç–∞</span>
        </div>
      </div>
      <div class="card home-banner-card" id="home-banner-card">
        <div class="label">–ü–æ–ø—É–ª—è—Ä–Ω—ã–π –Ω–∞–±–æ—Ä</div>
        <div class="category-cover" id="home-banner-cover">üß∫ ¬´–î–æ–º–∞—à–Ω–∏–π —É—é—Ç¬ª</div>
        <h3 id="home-banner-title">–ö–æ—Ä–∑–∏–Ω–∫–∞ + —Å–≤–µ—á–∞ + –ø–ª–µ–¥</h3>
        <p id="home-banner-subtitle">–¢—ë–ø–ª—ã–π –ø–æ–¥–∞—Ä–æ–∫ —Å —Ñ–∞–∫—Ç—É—Ä–Ω–æ–π –∫–æ—Ä–∑–∏–Ω–∫–æ–π, –∞—Ä–æ–º–∞—Ç–Ω–æ–π —Å–≤–µ—á–æ–π –∏ –º—è–≥–∫–∏–º –ø–ª–µ–¥–æ–º. –°–æ–±–∏—Ä–∞–µ–º –≤—Ä—É—á–Ω—É—é.</p>
        <a class="btn" id="home-banner-button" href="products.html">–°–º–æ—Ç—Ä–µ—Ç—å –≤ –∫–∞—Ç–∞–ª–æ–≥–µ</a>
      </div>
    </section>

    <h2>–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</h2>
    <div class="grid">
      <div class="card">
        <div class="category-cover">üß∫ –ö–æ—Ä–∑–∏–Ω–∫–∏</div>
        <h3>–ö–æ—Ä–∑–∏–Ω–∫–∏</h3>
        <p>–§–∞–∫—Ç—É—Ä–Ω—ã–µ –æ—Ä–≥–∞–Ω–∞–π–∑–µ—Ä—ã –∏ –ø–æ–¥–∞—Ä–æ—á–Ω—ã–µ –Ω–∞–±–æ—Ä—ã. –ü–æ–¥–æ–π–¥—É—Ç –¥–ª—è –¥–æ–º–∞ –∏ —É—é—Ç–Ω—ã—Ö —Å—é—Ä–ø—Ä–∏–∑–æ–≤.</p>
        <a class="btn" href="products.html">–°–º–æ—Ç—Ä–µ—Ç—å</a>
      </div>
      <div class="card">
        <div class="category-cover">üë∂ –õ—é–ª—å–∫–∏</div>
        <h3>–õ—é–ª—å–∫–∏</h3>
        <p>–ú—è–≥–∫–∏–µ –∫–æ–∫–æ–Ω—ã –∏ –ª—é–ª—å–∫–∏ –¥–ª—è –º–∞–ª—ã—à–µ–π, —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Å –∑–∞–±–æ—Ç–æ–π –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–º–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏.</p>
        <a class="btn" href="products.html">–°–º–æ—Ç—Ä–µ—Ç—å</a>
      </div>
      <div class="card">
        <div class="category-cover">üëú –°—É–º–∫–∏</div>
        <h3>–°—É–º–∫–∏</h3>
        <p>–¢—Ä–µ–Ω–¥–æ–≤—ã–µ –≤—è–∑–∞–Ω—ã–µ —Å—É–º–∫–∏ –∏ —à–æ–ø–ø–µ—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–±–∏—Ä–∞—é—Ç –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç—ã –∏ –Ω–æ—Å—è—Ç—Å—è –∫–∞–∂–¥—ã–π –¥–µ–Ω—å.</p>
        <a class="btn" href="products.html">–°–º–æ—Ç—Ä–µ—Ç—å</a>
      </div>
      <div class="card">
        <div class="category-cover">üéì –ú–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å—ã</div>
        <h3>–ú–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å—ã</h3>
        <p>–û–Ω–ª–∞–π–Ω-—É—Ä–æ–∫–∏ MiniDeN: –ø–ª–∞—Ç–Ω—ã–µ –∏ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∏ –ø–æ–¥—Ä–æ–±–Ω—ã–º–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏.</p>
        <a class="btn secondary" href="masterclasses.html">–ö –∫–∞—Ç–∞–ª–æ–≥—É –∫—É—Ä—Å–æ–≤</a>
      </div>
    </div>

    <h2>–ü–æ—á–µ–º—É MiniDeN</h2>
    <div class="benefits" id="why-list">
      <div class="benefit"><strong>‚ú® –†—É—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞</strong><p>–ö–∞–∂–¥–∞—è –∫–æ—Ä–∑–∏–Ω–∫–∞ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é: –ø–ª–æ—Ç–Ω—ã–µ —Å—Ç–µ–Ω–∫–∏, –∞–∫–∫—É—Ä–∞—Ç–Ω—ã–µ —à–≤—ã –∏ –ø—Ä–∏—è—Ç–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã.</p></div>
      <div class="benefit"><strong>üéÅ –ì–æ—Ç–æ–≤—ã–µ –ø–æ–¥–∞—Ä–∫–∏</strong><p>–ù–∞–±–æ—Ä—ã —É–∫–æ–º–ø–ª–µ–∫—Ç–æ–≤–∞–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ –≤—Ä—É—á–µ–Ω–∏—é: –æ—Å—Ç–∞—ë—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤—ã–±—Ä–∞—Ç—å —Å—Ç–∏–ª—å –∏ –¥–æ–±–∞–≤–∏—Ç—å –æ—Ç–∫—Ä—ã—Ç–∫—É.</p></div>
      <div class="benefit"><strong>üß∂ –£—á–∏–º—Å—è –≤–º–µ—Å—Ç–µ</strong><p>–ü–ª–∞—Ç–Ω—ã–µ –∏ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å—ã –ø–æ–º–æ–≥—É—Ç –æ—Å–≤–æ–∏—Ç—å –≤—è–∑–∞–Ω–∏–µ –∏ —É–ø–∞–∫–æ–≤–∫—É —Å –Ω—É–ª—è.</p></div>
      <div class="benefit"><strong>ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤ Telegram</strong><p>–ü–æ–º–æ–∂–µ–º –ø–æ–¥–æ–±—Ä–∞—Ç—å –∫–æ—Ä–∑–∏–Ω–∫—É, —Ä–∞—Å—Å–∫–∞–∂–µ–º –æ –¥–æ—Å—Ç–∞–≤–∫–µ –∏ –æ—Ç–≤–µ—Ç–∏–º –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –ø—Ä—è–º–æ –≤ —á–∞—Ç–µ.</p></div>
    </div>

    <h2>–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç</h2>
    <div class="step" id="how-intro">
      <strong>0) –í–æ–π–¥–∏—Ç–µ —á–µ—Ä–µ–∑ Telegram-–±–æ—Ç–∞</strong>
      <p>
        –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, –æ—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç–∞ MiniDeN –≤ Telegram –∏ –Ω–∞–∂–º–∏—Ç–µ ¬´–°—Ç–∞—Ä—Ç¬ª.
        –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∏, –∫–æ—Ä–∑–∏–Ω–∞ –∏ –ø—Ä–æ—Ñ–∏–ª—å –Ω–∞ —Å–∞–π—Ç–µ –±—É–¥—É—Ç —Å–≤—è–∑–∞–Ω—ã —Å –≤–∞—à–∏–º –∞–∫–∫–∞—É–Ω—Ç–æ–º.
      </p>
      <p style="margin-top:8px;">
        <a class="btn" id="bot-link-hero" href="https://t.me/BotMiniden_bot" target="_blank" rel="noopener">
          –û—Ç–∫—Ä—ã—Ç—å –±–æ—Ç–∞ MiniDeN
        </a>
      </p>
    </div>
    <div class="steps" id="how-list">
      <div class="step"><strong>1) –í—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–≤–∞—Ä –∏–ª–∏ –∫—É—Ä—Å</strong><p>–û—Ç–∫—Ä–æ–π—Ç–µ —Ä–∞–∑–¥–µ–ª ¬´–¢–æ–≤–∞—Ä—ã¬ª –∏–ª–∏ ¬´–ú–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å—ã¬ª –∏ –Ω–∞–π–¥–∏—Ç–µ —Ç–æ, —á—Ç–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –∏–º–µ–Ω–Ω–æ –≤–∞–º.</p></div>
      <div class="step"><strong>2) –î–æ–±–∞–≤—å—Ç–µ –≤ –∫–æ—Ä–∑–∏–Ω—É</strong><p>–ù–∞–∂–º–∏—Ç–µ ¬´–í –∫–æ—Ä–∑–∏–Ω—É¬ª –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ. –í –¥–µ–º–æ –ø–æ–∫–∞ –∑–∞–≥–ª—É—à–∫–∞, –ø–æ–∑–∂–µ –ø—Ä–∏–≤—è–∂–µ–º API –∏ Telegram-–±–æ—Ç–∞.</p></div>
      <div class="step"><strong>3) –û—Ñ–æ—Ä–º–∏—Ç–µ –∑–∞–∫–∞–∑</strong><p>–í —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –∑–∞–∫–∞–∑ –±—É–¥–µ—Ç —É—Ö–æ–¥–∏—Ç—å –≤ Telegram: –±–æ—Ç —É—Ç–æ—á–Ω–∏—Ç –¥–µ—Ç–∞–ª–∏ –∏ –ø–æ–º–æ–∂–µ—Ç –æ–ø–ª–∞—Ç–∏—Ç—å.</p></div>
    </div>
  </main>

  <section class="section" id="home-posts" style="display:none;">
    <h2>–ù–æ–≤–æ—Å—Ç–∏ –∏ –∏–¥–µ–∏</h2>
    <div class="home-posts-grid" id="home-posts-grid"></div>
    <div class="muted" id="home-posts-empty" style="display:none;">–°–∫–æ—Ä–æ –∑–¥–µ—Å—å –ø–æ—è–≤—è—Ç—Å—è –Ω–æ–≤–æ—Å—Ç–∏</div>
  </section>

  <footer>
    <div>
      –ì–æ—Ç–æ–≤—ã –ø–æ–º–æ—á—å –≤ Telegram:
      <a id="bot-link-footer" href="https://t.me/BotMiniden_bot" target="_blank" rel="noopener">–±–æ—Ç MiniDeN</a>
    </div>
    <div>
      –ù–æ–≤–æ—Å—Ç–∏ –∏ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ:
      <a id="channel-link-footer" href="https://t.me/petelka_za_petelko" target="_blank" rel="noopener">Telegram-–∫–∞–Ω–∞–ª</a>
    </div>
    <div>–ú—ã –≤ —Å–æ—Ü—Å–µ—Ç—è—Ö: <a href="https://www.instagram.com/balabanova_knit?igsh=MWhuMWFnOG8zejl6dQ==">Instagram*</a> ‚Ä¢ <a href="https://vk.com/club233836469">VK</a></div>
  </footer>

  <section class="section" id="telegram-login-section">
    <h2>–í—Ö–æ–¥ —á–µ—Ä–µ–∑ Telegram</h2>
    <p>
      –ß—Ç–æ–±—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–æ—Ä–∑–∏–Ω—É –∏ –ø—Ä–æ—Ñ–∏–ª—å —Å –±–æ—Ç–æ–º MiniDeN, –≤–æ–π–¥–∏—Ç–µ —á–µ—Ä–µ–∑ Telegram. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞ –≤—ã –±—É–¥–µ—Ç–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ –ø—Ä–æ—Ñ–∏–ª—å (profile.html), –≥–¥–µ —É–≤–∏–¥–∏—Ç–µ –≤–∞—à–∏ –∑–∞–∫–∞–∑—ã, –∫–æ—Ä–∑–∏–Ω—É –∏ –∫—É—Ä—Å—ã.
    </p>
    <div style="display:flex; gap:12px; align-items:center; flex-wrap:wrap;">
      <button class="btn" id="btn-login-telegram" type="button">–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Telegram</button>
    </div>
  </section>

  <section class="section" id="auth-status" style="display: none;">
    <h2>–í—ã —É–∂–µ –≤–æ—à–ª–∏</h2>
    <p id="auth-username" class="muted"></p>
    <div class="hero-cta">
      <a class="btn" href="/profile.html">–ü–µ—Ä–µ–π—Ç–∏ –≤ –ø—Ä–æ—Ñ–∏–ª—å</a>
      <button class="btn secondary" type="button" id="switch-user-btn">–°–º–µ–Ω–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
    </div>
  </section>

  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script src="js/app.js?v=20250412"></script>
  <script src="js/api.js?v=20250412"></script>
  <script src="js/home_page.js?v=20250412"></script>
  <script>
    const loginSection = document.getElementById('telegram-login-section');
    const authStatus = document.getElementById('auth-status');
    const authUsername = document.getElementById('auth-username');
    const switchUserBtn = document.getElementById('switch-user-btn');
    const adminLink = document.getElementById('admin-link');
    const loginButton = document.getElementById('btn-login-telegram');
    const loginButtonDefaultText = loginButton?.textContent || '–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Telegram';

    function updateAdminLinkVisibility(profile) {
      if (!adminLink) return;
      adminLink.style.display = profile?.is_admin ? 'inline-block' : 'none';
    }

    async function logout() {
      try {
        await fetch('/api/auth/logout', { method: 'POST' });
      } catch (e) {
        console.warn('Failed to call logout', e);
      } finally {
        window.location.reload();
      }
    }

    switchUserBtn?.addEventListener('click', logout);

    async function loadSession() {
      try {
        const user = await getCurrentUserProfile();
        updateAdminLinkVisibility(user);

        if (user) {
          loginSection?.style.setProperty('display', 'none');
          authStatus?.style.setProperty('display', 'block');
          const displayName = user.full_name || (user.telegram_username ? '@' + user.telegram_username : user.telegram_id);
          authUsername.textContent = `–í—ã –≤–æ—à–ª–∏ –∫–∞–∫ ${displayName}`;
        } else {
          loginSection?.style.setProperty('display', 'block');
          authStatus?.style.setProperty('display', 'none');
          if (loginButton) {
            loginButton.style.setProperty('display', 'inline-flex');
            loginButton.textContent = isTelegramWebApp ? '–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é' : loginButtonDefaultText;
          }
        }
      } catch (e) {
        console.error('Failed to load auth status', e);
        updateAdminLinkVisibility(null);
        loginSection?.style.setProperty('display', 'block');
        authStatus?.style.setProperty('display', 'none');
      }
    }

    loginButton?.addEventListener('click', async () => {
      if (isTelegramWebApp) {
        loginButton.disabled = true;
        try {
          await telegramWebAppAutoLogin();
          await loadSession();
        } finally {
          loginButton.disabled = false;
        }
        return;
      }

      startTelegramOAuthFlow();
    });

    async function bootstrapAuth() {
      await processTelegramAuthFromUrl().catch((error) => {
        console.error('Telegram auth via browser failed', error);
        showToast(error?.message || '–ù–µ —É–¥–∞–ª–æ—Å—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ Telegram');
      });

      if (isTelegramWebApp) {
        await telegramWebAppAutoLogin();
      }

      await loadSession();
    }

    bootstrapAuth();
  </script>
</body>
</html>
