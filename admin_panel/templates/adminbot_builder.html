<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –±–æ—Ç–∞ ‚Äî AdminBot</title>
    <link rel="stylesheet" href="{{ url_for('static', path='adminsite/base.css') }}">
    <style>
        .builder-hero {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: #0b1220;
            padding: 24px;
            border-radius: 14px;
            margin-bottom: 24px;
            box-shadow: 0 8px 30px rgba(168, 85, 247, 0.25);
        }
        .builder-hero h1 {
            margin: 0 0 8px;
            font-size: 28px;
            font-weight: 800;
        }
        .builder-hero p {
            margin: 0 0 12px;
            font-size: 15px;
            opacity: 0.9;
        }
        .builder-hero .quick-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 16px;
        }
        .section-card {
            display: flex;
            flex-direction: column;
            gap: 12px;
            height: 100%;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .section-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.3);
        }
        .section-status {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            border-radius: 999px;
            font-size: 13px;
            font-weight: 600;
            width: fit-content;
        }
        .section-status.ok {
            background: rgba(52, 211, 153, 0.2);
            color: var(--success);
            border: 1px solid var(--success);
        }
        .section-status.warn {
            background: rgba(251, 191, 36, 0.2);
            color: #fbbf24;
            border: 1px solid #fbbf24;
        }
        .section-status.fail {
            background: rgba(248, 113, 113, 0.2);
            color: var(--danger);
            border: 1px solid var(--danger);
        }
        .section-title {
            font-size: 18px;
            font-weight: 700;
            margin: 0;
            color: var(--text);
        }
        .section-description {
            color: var(--muted);
            font-size: 14px;
            line-height: 1.5;
            flex: 1;
        }
        .section-hint {
            color: var(--muted);
            font-size: 13px;
            font-style: italic;
            padding-top: 8px;
            border-top: 1px solid var(--border);
        }
        .wizard-card {
            background: var(--card);
            border: 2px dashed var(--primary);
            border-radius: 14px;
            padding: 20px;
            margin-top: 24px;
        }
        .wizard-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
        }
        .wizard-header h3 {
            margin: 0;
            color: var(--text);
            font-size: 20px;
        }
        .wizard-close {
            background: transparent;
            border: none;
            color: var(--muted);
            font-size: 24px;
            cursor: pointer;
            padding: 0;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            transition: background 0.2s ease;
        }
        .wizard-close:hover {
            background: var(--border);
        }
        .wizard-step {
            display: none;
            padding: 16px;
            background: #0b1220;
            border-radius: 12px;
            border: 1px solid var(--border);
        }
        .wizard-step.active {
            display: block;
        }
        .wizard-step strong {
            display: block;
            font-size: 16px;
            color: var(--text);
            margin-bottom: 8px;
        }
        .wizard-step p {
            color: var(--muted);
            font-size: 14px;
            margin-bottom: 16px;
        }
        .wizard-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .wizard-progress {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
        }
        .wizard-progress-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--border);
            transition: background 0.2s ease;
        }
        .wizard-progress-dot.active {
            background: var(--primary);
        }
        .page-actions {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 16px;
            margin-bottom: 24px;
            flex-wrap: wrap;
        }
        .info-box {
            background: rgba(168, 85, 247, 0.1);
            border: 1px solid var(--primary);
            border-radius: 12px;
            padding: 16px;
            max-width: 400px;
        }
        .info-box .badge-list {
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
<header class="site-header">
    <div class="brand-area">
        <div class="brand">AdminBot</div>
    </div>
    <nav class="main-nav">
        <a href="/adminbot">–ì–ª–∞–≤–Ω–∞—è</a>
        <a href="/adminbot/builder" style="background: rgba(0,0,0,0.12);">–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä</a>
        <a href="/adminbot/templates">–®–∞–±–ª–æ–Ω—ã</a>
        <a href="/adminbot/nodes">–£–∑–ª—ã</a>
        <a href="/adminbot/triggers">–¢—Ä–∏–≥–≥–µ—Ä—ã</a>
        <a href="/adminbot/automations">–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏</a>
        <a href="/adminbot/integrity">–ü—Ä–æ–≤–µ—Ä–∫–∞</a>
        <a href="/adminbot/runtime">–†–∞–±–æ—Ç–∞ –±–æ—Ç–∞</a>
        <form method="post" action="/adminbot/logout" class="logout-form">
            <button class="btn-secondary" type="submit">–í—ã–π—Ç–∏</button>
        </form>
    </nav>
</header>

<main class="page-container">
    <div class="page-actions">
        <div>
            <h1>–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –±–æ—Ç–∞</h1>
            <p class="muted">–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –≤—Å–µ—Ö —Ä–∞–∑–¥–µ–ª–æ–≤ –∏ –±—ã—Å—Ç—Ä–æ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º. –í—Å—ë –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ.</p>
        </div>
        <div class="info-box">
            <div class="badge-list">
                <span class="tag">–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç</span>
                <span class="tag">–®–∞–±–ª–æ–Ω—ã</span>
                <span class="tag">–ü—Ä–æ–≤–µ—Ä–∫–∞</span>
            </div>
            <p style="margin:0; font-size:13px;">–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —à–∞–±–ª–æ–Ω—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ —Å–≤–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π —Å –Ω—É–ª—è.</p>
        </div>
    </div>

    <div class="builder-hero">
        <h1>üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç</h1>
        <p>–°—Ç–∞—Ä—Ç–æ–≤—ã–π —É–∑–µ–ª: <strong>{{ start_node_code }}</strong></p>
        <div class="quick-actions">
            <a href="/adminbot/templates" class="btn-primary">üìã –í—ã–±—Ä–∞—Ç—å —à–∞–±–ª–æ–Ω</a>
            <a href="/adminbot/integrity" class="btn-secondary">üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å</a>
        </div>
    </div>

    <div class="grid two-columns">
        {% for section in sections %}
        <div class="card section-card">
            <div class="section-status {{ section.status.class }}">
                <span>{{ section.status.icon }}</span>
                <span>{{ section.status.label }}</span>
            </div>
            <h3 class="section-title">{{ section.title }}</h3>
            <p class="section-description">{{ section.description }}</p>
            {% if section.hint %}
            <div class="section-hint">üí° {{ section.hint }}</div>
            {% endif %}
            <div class="actions">
                <a href="{{ section.url }}" class="btn-primary">–ù–∞—Å—Ç—Ä–æ–∏—Ç—å ‚Üí</a>
            </div>
        </div>
        {% endfor %}
    </div>

    <div class="wizard-card" id="builder-wizard">
        <div class="wizard-header">
            <h3>üìö –ú–∞—Å—Ç–µ—Ä –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤</h3>
            <button class="wizard-close" type="button" data-skip aria-label="–ó–∞–∫—Ä—ã—Ç—å">√ó</button>
        </div>
        <div class="wizard-progress">
            <div class="wizard-progress-dot active" data-progress="0"></div>
            <div class="wizard-progress-dot" data-progress="1"></div>
            <div class="wizard-progress-dot" data-progress="2"></div>
        </div>
        <div class="wizard-step active" data-step="1">
            <strong>–®–∞–≥ 1: –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</strong>
            <p>–°–æ–∑–¥–∞–π—Ç–µ —É–∑–µ–ª ¬´–ü—Ä–æ—Ñ–∏–ª—å¬ª –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ. –ú—ã –ø—Ä–µ–¥–ª–æ–∂–∏–º –¥–æ–±–∞–≤–∏—Ç—å ¬´–ú–æ–∏ –∑–∞–∫–∞–∑—ã¬ª –∏ ¬´–ö–æ–Ω—Ç–∞–∫—Ç—ã/–ü–æ–º–æ—â—å¬ª.</p>
            <div class="wizard-actions">
                <button type="button" class="btn-primary" data-next>–î–∞–ª—å—à–µ ‚Üí</button>
                <button type="button" class="btn-secondary" data-skip>–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å</button>
            </div>
        </div>
        <div class="wizard-step" data-step="2">
            <strong>–®–∞–≥ 2: –ö–æ—Ä–∑–∏–Ω–∞ –∏ –∑–∞–∫–∞–∑—ã</strong>
            <p>–í–∫–ª—é—á–∏—Ç–µ –∫–æ—Ä–∑–∏–Ω—É –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—é –∑–∞–∫–∞–∑–∞ –∏–∑ WebApp. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–∞–∫–µ—Ç ¬´–ö–æ—Ä–∑–∏–Ω–∞ + –ó–∞–∫–∞–∑—ã¬ª –¥–ª—è –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏.</p>
            <div class="wizard-actions">
                <button type="button" class="btn-primary" data-next>–î–∞–ª—å—à–µ ‚Üí</button>
                <button type="button" class="btn-secondary" data-skip>–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å</button>
            </div>
        </div>
        <div class="wizard-step" data-step="3">
            <strong>–®–∞–≥ 3: –ü–æ–º–æ—â—å –∏ –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å</strong>
            <p>–î–æ–±–∞–≤—å—Ç–µ —É–∑–ª—ã ¬´–ü–æ–º–æ—â—å¬ª –∏ ¬´–°–≤—è–∑–∞—Ç—å—Å—è¬ª, —á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥–ª–∏ –±—ã—Å—Ç—Ä–æ –Ω–∞–ø–∏—Å–∞—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –∏ –ø–æ–ª—É—á–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É.</p>
            <div class="wizard-actions">
                <a href="/adminbot/templates" class="btn-primary">–í—ã–±—Ä–∞—Ç—å —à–∞–±–ª–æ–Ω</a>
                <button type="button" class="btn-secondary" data-skip>–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>
</main>

<script>
(function () {
    const wizard = document.getElementById('builder-wizard');
    if (!wizard) return;
    
    const steps = Array.from(wizard.querySelectorAll('.wizard-step'));
    const progressDots = Array.from(wizard.querySelectorAll('.wizard-progress-dot'));
    let current = 0;

    function showStep(index) {
        steps.forEach((step, idx) => {
            step.classList.toggle('active', idx === index);
        });
        progressDots.forEach((dot, idx) => {
            dot.classList.toggle('active', idx <= index);
        });
    }

    function hideWizard() {
        wizard.style.display = 'none';
        localStorage.setItem('adminbot-wizard-hidden', 'true');
    }

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –±—ã–ª –ª–∏ –º–∞—Å—Ç–µ—Ä —Å–∫—Ä—ã—Ç —Ä–∞–Ω–µ–µ
    if (localStorage.getItem('adminbot-wizard-hidden') === 'true') {
        wizard.style.display = 'none';
    }

    wizard.addEventListener('click', (event) => {
        if (event.target.matches('[data-next]')) {
            current = Math.min(current + 1, steps.length - 1);
            showStep(current);
        }
        if (event.target.matches('[data-skip]')) {
            hideWizard();
        }
    });
})();
</script>
</body>
</html>
